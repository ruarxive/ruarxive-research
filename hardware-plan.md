# Сервер для национального цифрового архива

Версия 1.0
## Цель 

Сайт проекта: https://ruarxive.org
Сбор и долгосрочное хранение зеркальных копий сайтов и данных в национальном цифровом архиве, а также баз данных и цифровых коллекций от граждан и компаний.

Мировые аналоги: archive.org и webarchive.org.uk

## Задачи

* иметь возможность хранить от 200TB
* обеспечивать ежемесячный трафик от 3 до 10TB (входящий и исходящий)
* хостить несколько процессов краулеров всех сайтов в зонах .рф, .ru, .su
* хостить сервис загрузки больших объёмов данных


## Идеальная конфигурация

Это не та конфигурация которая сейчас рассматривается, это идеальная конфигурация которая обеспечивала бы должную сохранность и  
* Внешний канал от 1GB
* Хранилище на 1PB+
* Оперативная память от 256GB
* Несколько серверов с резервированием
* Ленточная библиотека для резервных копий


## Варианты

### Вариант 1. Colocation 4U на Selectel, канал в 1GB, 408TB хранения

Объём хранения (raw): 432TB
Объём хранения (RAID6): 408TB

**при использовании канала в 1GB**
Общая стоимость за год: 1976 тыс. руб
Общая стоимость 3 год: 2978 тыс. руб
Общая стоимость 5 лет: 3980 тыс. руб

**без канала в 1GB**
Общая стоимость за год: 1547 тыс. руб
Общая стоимость 3 год: 1781 тыс. руб
Общая стоимость 5 лет: 2015 тыс. руб

**Стоимость**
|Конфигурация|Стоимость 1 год|Стоимость 3 года|Стоимость 5 лет|TB за 1 год|TB за 3 года|TB за 5 лет|
|:-----------------------------|:--------------:|:------------:|:-------------:|----:|--:|--:|
|С трафиком и каналами|1976|2978|3980|4,84|2,43|1,95|
|Без канала в 1GB|1547|1781|2015|3,55|1,45|0,98|

**Компоненты**

|Компонент|Количество|Цена за 1, т.р.|Стоимость, т.р.|
|:-----------------------------|:--------------:|:------------:|:-------------:|
|Серверная платформа SuperMicro SSG-6048R-E1CR36N|1|234|234
|Оперативная память 128GB (8x16GB) DDR4 2400|1|121|121
|Процессор Intel Core i7 - 6900K OEM|2|62|124|
|Диски 12GB HGST HUH721212ALE604|36|26|936|
|Colocation на 4U|1|6|72|
|Внешний канал на 1GB|1|32|384|
|Трафик TB в месяц|10|3.75|45|
|**Итого**      |||**1976**|


**Структура расходов. При полной комплектации**
Диски и платформа приобретаются сразу, остальное оплачивается по мере необходимости
Разовый платёж на покупку: 1475 тыс. руб.
Ежемесячный платёж: 41.75 тыс. руб.

**Структура расходов. При постепенном наращивании комплектации**

Платформа, процессоры и оперативная память покупаются сразу и приобретается 1/3 часть дисков.
Разовый платёж на покупку: 851 тыс. руб.
2 платежа по 312 тысяч в течение года: 624 тыс. руб.
Ежемесячный платёж: 41.75 тыс. руб.

**Структура расходов. При постепенном наращивании комплектации и без канала в 1 GB**

Платформа, процессоры и оперативная память покупаются сразу и приобретается 1/3 часть дисков.
Разовый платёж на покупку: 851 тыс. руб.
2 платежа по 312 тысяч в течение года: 624 тыс. руб.
Ежемесячный платёж: 9.75 тыс. руб.

### Вариант 2. Colocation 4U на Selectel, канал в 100MB, 272TB хранения

Объём хранения (raw): 288TB
Объём хранения (RAID6): 272TB
Общая стоимость за год: 1208 тыс. руб
Общая стоимость 3 года: 1442 тыс. руб
Общая стоимость 5 лет: 1676 тыс. руб


**Стоимость**
|Конфигурация|Стоимость 1 год|Стоимость 3 года|Стоимость 5 лет|TB за 1 год|TB за 3 года|TB за 5 лет|
|:-----------------------------|:--------------:|:------------:|:-------------:|----:|--:|--:|
|Без канала в 1GB|1208|1442|1676|4,44|1,77|1,23|

**Компоненты**

|Компонент|Количество|Цена за 1, т.р.|Стоимость, т.р.|
|:-----------------------------|:--------------:|:------------:|:-------------:|
|Серверная платформа SuperMicro SSG-6048R-E1CR36N|1|234|234
|Оперативная память 128GB (8x16GB) DDR4 2400|1|121|121
|Процессор Intel Core i7 - 6900K OEM|2|62|124|
|Диски 8GB HGST HDN728080ALE604|36|17|612|
|Colocation на 4U|1|6|72|
|Трафик TB в месяц|10|3.75|45|
|**Итого**      |||**1208**|


**Структура расходов. При полной комплектации**
Диски и платформа приобретаются сразу, остальное оплачивается по мере необходимости
Разовый платёж на покупку: 1091 тыс. руб.
Ежемесячный платёж: 9.75 тыс. руб.

**Структура расходов. При постепенном наращивании комплектации**

Платформа, процессоры и оперативная память покупаются сразу и приобретается 1/3 часть дисков.
Разовый платёж на покупку: 683 тыс. руб.
2 платежа по 204 тысяч в течение года: 408 тыс. руб.
Ежемесячный платёж: 9.75 тыс. руб.


## Способы снижения издержек

К сожалению издержки на само железо сильно ограничены. Можно попытаться сэкономить на объёме оперативной памяти и взять более дешёвые процессоры, но это приведёт к ухудшению работы краулеров. 
Итоговые варианты:
* найти болеее дешёвый colocation, трафик и каналы в Москве
* договориться с каким-либо хостером о бесплатной установке в 4U (даст экономию до 72 т.р.)
* договориться с каким-либо хостером о бесплатном канале в 1GB (даст экономию до 384 т.р. по ценам Selectel'а)
* другие варианты 

## Источники оценки стоимости и конфигурации

* Colocation, каналы и трафик https://selectel.ru/services/colocation/server-colocation/?location=6
* Серверная платформа https://www.regard.ru/catalog/tovar172141.htm?ymclid=258512994008196639000002
* Процессор https://www.regard.ru/catalog/tovar225027.htm
* Диски 8TB https://market.yandex.ru/catalog/55316/list?text=%D0%B6%D0%B5%D1%81%D1%82%D0%BA%D0%B8%D0%B9%20%D0%B4%D0%B8%D1%81%D0%BA%208%20%D1%82%D0%B1&hid=91033&rt=11&was_redir=1&rs=eJwzSlcy5pK7sO3C1ouNF5su7Lqw48JOhQtbLuy42Hhhl4KFAlBso8Dc7zuYlFg4eAX4gCS_gKAGg5EBlx4XL0fjcVYBJgkG1XgDkX1AbheQywjk3v65wo6Lj2MmkMsgcU9eVaJIxAEA4YMj0w%2C%2C&glfilter=5127069%3A8388608~8388608&local-offers-first=0
* Диски 12 TB https://market.yandex.ru/catalog/55316/list?text=%D0%B6%D0%B5%D1%81%D1%82%D0%BA%D0%B8%D0%B9%20%D0%B4%D0%B8%D1%81%D0%BA%2012%20%D1%82%D0%B1&hid=91033&suggest=2&rt=11&was_redir=1&rs=eJwzylAy4ZK_sO3C1ouNF5su7Lqw48JOhQtbLuy42Hhhl4KhkQJQcKPA3O87mJRYOHgF-IGkgICQBoORAZceFy9H43FWASYJBtX51R02QG4XkMsI5H5P5rfn4uOYCeQySLTIqPZekHQAAP_qI-o%2C&glfilter=5127069%3A12582912~12582912&local-offers-first=0


## Контакты

ibegtin@infoculture.ru и https://t.me/ibegtin
